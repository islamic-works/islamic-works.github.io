{% comment %}
  SEO metadata include for Islamic Works site.
  Supports optional front matter fields:
    seo_title, description, summary, keywords (array), tags (array), image, og_image,
    canonical, lang, og_type, twitter_card, author, authors, robots.
  Falls back to site defaults defined in _config.yml.
{% endcomment %}
{% assign seo_title = page.seo_title | default: page.title | default: site.title %}
{% assign seo_description = page.description | default: page.summary | default: page.excerpt | default: site.description %}
{% assign seo_keywords = page.keywords | default: page.tags | default: site.keywords %}
{% assign seo_image = page.og_image | default: page.image | default: site.social_image %}
{% capture canonical_url %}
  {% if page.canonical %}
    {{ page.canonical | absolute_url }}
  {% elsif page.url %}
    {{ page.url | replace: 'index.html', '' | absolute_url }}
  {% else %}
    {{ site.url | append: site.baseurl }}
  {% endif %}
{% endcapture %}
{% assign seo_lang = page.lang | default: site.lang | default: 'pt-BR' %}
{% assign og_type = page.og_type | default: site.og_type | default: 'article' %}
{% assign twitter_card = page.twitter_card | default: site.twitter_card | default: 'summary_large_image' %}

<title>{{ seo_title }}{% unless site.title == seo_title %} | {{ site.title }}{% endunless %}</title>
<meta name="description" content="{{ seo_description | strip_html | strip_newlines | strip }}" />

{% if seo_keywords %}
  {% if seo_keywords == seo_keywords | join: ',' %}
    {% assign keywords_content = seo_keywords %}
  {% else %}
    {% assign keywords_content = seo_keywords | join: ', ' %}
  {% endif %}
  <meta name="keywords" content="{{ keywords_content }}" />
{% endif %}

{% if canonical_url %}
  <link rel="canonical" href="{{ canonical_url | strip }}" />
{% endif %}

<meta property="og:locale" content="{{ seo_lang }}" />
<meta property="og:site_name" content="{{ site.title }}" />
<meta property="og:type" content="{{ og_type }}" />
<meta property="og:title" content="{{ seo_title }}" />
<meta property="og:description" content="{{ seo_description | strip_html | strip_newlines | strip }}" />
<meta property="og:url" content="{{ canonical_url | strip }}" />
{% if seo_image %}
  <meta property="og:image" content="{{ seo_image | absolute_url }}" />
{% endif %}

<meta name="twitter:card" content="{{ twitter_card }}" />
<meta name="twitter:title" content="{{ seo_title }}" />
<meta name="twitter:description" content="{{ seo_description | strip_html | strip_newlines | strip }}" />
{% if seo_image %}
  <meta name="twitter:image" content="{{ seo_image | absolute_url }}" />
{% endif %}

{% if page.author %}
  <meta name="author" content="{{ page.author }}" />
{% elsif page.authors %}
  {% assign authors_list = page.authors | join: ', ' %}
  <meta name="author" content="{{ authors_list }}" />
{% elsif site['author-name'] %}
  <meta name="author" content="{{ site['author-name'] }}" />
{% endif %}

{% if page.robots %}
  <meta name="robots" content="{{ page.robots }}" />
{% elsif site.robots %}
  <meta name="robots" content="{{ site.robots }}" />
{% endif %}
